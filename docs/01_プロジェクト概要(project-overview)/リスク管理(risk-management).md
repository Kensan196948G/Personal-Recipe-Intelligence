# リスク管理 (Risk Management)

## 1. 概要

本ドキュメントは、Personal Recipe Intelligence (PRI) プロジェクトにおけるリスクの特定、評価、対策を定義する。

## 2. リスク評価基準

### 2.1 影響度

| レベル | 説明 | 例 |
|--------|------|-----|
| 高 | プロジェクト継続困難 | 主要機能が実現不可 |
| 中 | 大幅な変更が必要 | スケジュール遅延 |
| 低 | 軽微な影響 | 一部機能の制限 |

### 2.2 発生確率

| レベル | 確率 | 説明 |
|--------|------|------|
| 高 | 70%以上 | ほぼ確実に発生 |
| 中 | 30-70% | 発生する可能性あり |
| 低 | 30%未満 | 発生しにくい |

### 2.3 リスクスコア

```
リスクスコア = 影響度 × 発生確率

高×高 = 9 (最重要)
高×中 = 6 (重要)
高×低 = 3 (注意)
中×中 = 4 (注意)
中×低 = 2 (監視)
低×低 = 1 (許容)
```

## 3. リスク一覧

### 3.1 技術的リスク

| ID | リスク | 影響度 | 確率 | スコア | 対策 |
|----|--------|--------|------|--------|------|
| T-01 | スクレイピング禁止 | 高 | 中 | 6 | 手動入力機能、API利用 |
| T-02 | OCR精度不足 | 中 | 中 | 4 | 手動補正機能 |
| T-03 | DeepL API制限 | 中 | 高 | 6 | キャッシュ、代替翻訳 |
| T-04 | サイト構造変更 | 中 | 高 | 6 | 柔軟なパーサー設計 |
| T-05 | パフォーマンス問題 | 中 | 中 | 4 | インデックス最適化 |

### 3.2 運用リスク

| ID | リスク | 影響度 | 確率 | スコア | 対策 |
|----|--------|--------|------|--------|------|
| O-01 | データ消失 | 高 | 低 | 3 | 定期バックアップ |
| O-02 | ディスク容量不足 | 低 | 中 | 2 | 監視、アーカイブ |
| O-03 | 依存パッケージ脆弱性 | 中 | 中 | 4 | 定期スキャン |

### 3.3 外部リスク

| ID | リスク | 影響度 | 確率 | スコア | 対策 |
|----|--------|--------|------|--------|------|
| E-01 | 外部API停止 | 高 | 低 | 3 | 代替サービス検討 |
| E-02 | 利用規約変更 | 中 | 中 | 4 | 規約の定期確認 |
| E-03 | ライセンス問題 | 中 | 低 | 2 | OSS確認 |

## 4. 重要リスクの詳細

### 4.1 T-01: スクレイピング禁止

**説明**
レシピサイトがスクレイピングを禁止し、データ取得ができなくなるリスク。

**影響**
- 自動レシピ収集機能が使用不可
- 手動入力のみに制限

**対策**
1. robots.txtの遵守
2. 適切なリクエスト間隔
3. 手動入力機能の充実
4. 公式APIがあれば利用

**監視方法**
- スクレイピング成功率の監視
- エラーログの確認

### 4.2 T-03: DeepL API制限

**説明**
DeepL APIの利用制限に達し、翻訳機能が使用できなくなるリスク。

**影響**
- 海外レシピの翻訳不可
- 新規海外レシピの追加制限

**対策**
1. 翻訳結果のキャッシュ
2. 翻訳回数の監視
3. 代替翻訳サービスの検討
4. レート制限の実装

**監視方法**
- API使用量の監視
- 月次使用量レポート

### 4.3 T-04: サイト構造変更

**説明**
レシピサイトのHTML構造が変更され、スクレイピングが失敗するリスク。

**影響**
- 特定サイトからの収集不可
- パーサーの修正が必要

**対策**
1. 複数のセレクタパターン
2. 構造変更検知機能
3. 柔軟なパーサー設計
4. 定期的な動作確認

**監視方法**
- サイト別成功率の監視
- エラー通知

## 5. リスク対応計画

### 5.1 予防措置

| リスクID | 予防措置 | 実施時期 |
|----------|----------|----------|
| T-01 | robots.txt確認 | スクレイピング前 |
| T-03 | キャッシュ実装 | Phase 2 |
| T-04 | 柔軟なパーサー | Phase 2 |
| O-01 | バックアップ設定 | Phase 1 |

### 5.2 緊急対応

| リスクID | 発生時対応 | 担当 |
|----------|------------|------|
| T-01 | 該当サイト無効化、手動入力案内 | 開発者 |
| T-03 | キャッシュ利用、翻訳一時停止 | 自動 |
| O-01 | バックアップからリストア | 開発者 |

## 6. リスク監視

### 6.1 監視項目

| 項目 | 頻度 | 閾値 | アクション |
|------|------|------|------------|
| スクレイピング成功率 | 日次 | 80%未満 | パーサー確認 |
| API使用量 | 週次 | 80%到達 | 使用量削減 |
| エラー件数 | 日次 | 10件以上 | 原因調査 |
| ディスク使用量 | 週次 | 80%到達 | アーカイブ |

### 6.2 報告

| 報告種別 | 頻度 | 内容 |
|----------|------|------|
| 定期報告 | 月次 | リスク状況サマリ |
| 緊急報告 | 発生時 | 重大リスク発生 |

## 7. リスク登録簿テンプレート

```markdown
## リスクID: T-XX

**リスク名**:
**説明**:
**影響度**: 高/中/低
**発生確率**: 高/中/低
**スコア**:
**ステータス**: 監視中/対応中/解決済

### 対策
1.

### 監視方法


### 発生時対応


### 更新履歴
| 日付 | 内容 |
|------|------|
```

## 8. 改訂履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|----------|
| 2024-12-11 | 1.0.0 | 初版作成 |
